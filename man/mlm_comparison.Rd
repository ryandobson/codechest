% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mlm_comparison.R
\name{mlm_comparison}
\alias{mlm_comparison}
\title{Iterative Random-Effects Structure Comparison for Mixed Models}
\usage{
mlm_comparison(
  data,
  dv,
  fixed_effects,
  random_effects,
  group,
  model_env = NULL,
  history = NULL,
  counter = 1,
  allow_drop_intercept = FALSE
)
}
\arguments{
\item{data}{A data frame containing all variables referenced in the model.}

\item{dv}{Character scalar; dependent variable name.}

\item{fixed_effects}{Character vector of fixed-effect terms (may include interactions).}

\item{random_effects}{Character vector of random-effect terms (include \code{"1"} for RI).}

\item{group}{Character scalar; grouping variable for random effects.}

\item{model_env}{Optional environment for the created formulas (default: new env with
\code{globalenv()} as parent if \code{NULL}).}

\item{history}{Optional existing history list; if \code{NULL}, a new history is created.}

\item{counter}{Integer step counter for logging (default \code{1}).}

\item{allow_drop_intercept}{Logical; if \code{TRUE}, RI vs fixed comparison is allowed.}
}
\value{
A \emph{history} list (log book) of steps, ending with an explicit
\code{type = "final_model"} entry. Use \code{\link{final_model_mlm_comparison}} to retrieve
the kept fit.
}
\description{
Automates a pragmatic workflow for simplifying and comparing random-effects
structures in mixed-effects models:
\enumerate{
\item Fit the starting model with \strong{uncorrelated} random effects.
\item If there are random slopes, iteratively drop the smallest-variance slope and
compare via LRT; accept the simpler model if \eqn{p > .20}.
\item If a drop is not accepted (\eqn{p \le .20}), compare uncorrelated vs
correlated random effects; accept the simpler uncorrelated model if
\eqn{p > .20}, else the correlated model.
\item If only a random intercept is present:
\itemize{
\item If \code{allow_drop_intercept = TRUE}, compare RI-lmer vs fixed-effects lm
using the chi-bar 1/2 adjustment (accept lm if \code{(p/2) > .20}).
\item Otherwise, keep RI.
}
}
}
\details{
Uses \code{\link{build_formula}} to construct formulas, \code{lmerTest::lmer} to fit
mixed models (\code{REML = FALSE}), and \code{\link{drop_smallest_term}} (which calls
\code{\link{extract_smallest_slope}}) for slope-dropping steps. Model comparisons are
performed via \code{anova(model1, model2)}.
}
\examples{
\dontrun{
H <- mlm_comparison(
  data = df,
  dv = "y",
  fixed_effects = c("x1", "x2"),
  random_effects = c("1", "x1", "x2"),
  group = "id",
  allow_drop_intercept = FALSE
)
final_fit <- final_model_mlm_comparison(H)
}

}
\seealso{
\code{\link{build_formula}}, \code{\link{drop_smallest_term}},
\code{\link{extract_smallest_slope}}, \code{\link{final_model_mlm_comparison}},
\code{\link{append_step_mlm_comparison}}, \code{\link{init_history}}
}
